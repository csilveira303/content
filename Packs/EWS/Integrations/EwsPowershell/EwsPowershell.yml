category: Messaging
commonfields:
  id: EwsPowershell
  version: -1
configuration:
- display: UPN
  name: upn
  required: true
  type: 0
- defaultvalue: https://ps.outlook.com
  display: Search and Compliance URI
  name: compliance_and_search_uri
  required: true
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: EWS Powershell integration use Oauth2.0 and enable executing commands in Microsoft Echange Online and Microsoft Search and Compliance.
display: EWS Powershell
name: EwsPowershell
script:
  commands:
  - arguments:
    - default: false
      description: Search name.
      isArray: false
      name: search_name
      required: true
      secret: false
    - default: false
      defaultvalue: false
      description: Whether to include mailboxes other than regular user mailboxes in the compliance search.
      isArray: false
      name: allow_not_found_exchange_location 
      required: true
      secret: false
    - default: false
      description: Keyword Query Language (KQL).
      isArray: false
      name: kql_query 
      required: false
      secret: false
    - default: false
      description: Description.
      isArray: false
      name: description 
      required: false
      secret: false
    - default: false
      description: Mailboxes to include. (Comma seprated)
      isArray: true
      name: exchange_location
      required: true
      secret: false
    - default: false
      description: Mailboxes to exlude. (Comma seprated)
      isArray: true
      name: exchange_location_exclustion
      required: true
      secret: false
    deprecated: false
    description: Creates a new compliance search configuration.
    execution: false
    name: ews-compliance-new-search
  - arguments:
    - default: false
      description: Search name.
      isArray: false
      name: search_name
      required: true
      secret: false
    deprecated: false
    description: Remove compliance search configuration.
    execution: false
    name: ews-compliance-remove-search
  - arguments:
    - default: false
      description: Search name.
      isArray: false
      name: search_name
      required: true
      secret: false
    deprecated: false
    description: Start compliance search configuration.
    execution: false
    name: ews-compliance-start-search
  - arguments:
    - default: false
      description: Search name.
      isArray: false
      name: search_name
      required: true
      secret: false
    deprecated: false
    description: Stop compliance search configuration.
    execution: false
    name: ews-compliance-stop-search
  - arguments:
    - default: false
      description: Search name.
      isArray: false
      name: search_name
      required: true
      secret: false
    deprecated: false
    description: Get compliance search configuration.
    execution: false
    name: ews-compliance-get-search
  - deprecated: false
    description: List compliance search configurations.
    execution: false
    name: ews-compliance-list-search
  - arguments:
    - default: false
      description: Search name.
      isArray: false
      name: search_name
      required: true
      secret: false
    - default: false
      description: Purge type (Hard-Unrecoverable/Soft-Recoverable).
      isArray: false
      name: purge_type
      required: true
      secret: false
      predefined:
        - Soft
        - Hard
    deprecated: false
    description: Purge (remove) messages by search performed in compliance.
    execution: false
    name: ews-compliance-purge-search
  - deprecated: false
    description: Start login using Oauth2.0.
    execution: false
    name: ews-start-auth
  - deprecated: false
    description: Complete login using Oauth2.0.
    execution: false
    name: ews-complete-auth
  - deprecated: false
    description: Test login using Oauth2.0.
    execution: false
    name: ews-test
  - deprecated: false
    description: Print integration context.
    hidden: true
    execution: false
    name: ews-integration-context
  dockerimage: demisto/powershell-ubuntu:7.0.3.12001
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: powershell
fromversion: 5.5.0
